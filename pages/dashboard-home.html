<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - Batik Nusantara</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      .sidebar {
        width: 250px;
        transition: all 0.3s;
      }

      @media (max-width: 768px) {
        .sidebar {
          width: 0;
          overflow: hidden;
        }

        .sidebar.open {
          width: 250px;
        }

        .content {
          margin-left: 0 !important;
        }
      }

      .content {
        margin-left: 250px;
        transition: all 0.3s;
      }
    </style>
  </head>
  <body class="bg-gray-100 min-h-screen">
    <!-- Alert Container -->
    <div id="alert-container" class="fixed top-4 right-4 z-50 hidden"></div>

    <!-- Sidebar -->
    <div class="sidebar fixed top-0 left-0 h-full bg-amber-800 text-white z-10">
      <div class="p-4 border-b border-amber-700">
        <div class="flex items-center justify-between">
          <h1 class="text-xl font-bold">Batik Nusantara</h1>
          <button id="close-sidebar" class="md:hidden text-white">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <p class="text-sm text-amber-200">Admin Panel</p>
      </div>

      <nav class="mt-4">
        <a
          href="dashboard-home.html"
          class="nav-link flex items-center px-4 py-3 hover:bg-amber-700 transition"
        >
          <i class="fas fa-chart-line w-6 mr-3"></i>
          <span>Dashboard</span>
        </a>
        <a
          href="dashboard-products.html"
          class="nav-link flex items-center px-4 py-3 hover:bg-amber-700 transition"
        >
          <i class="fas fa-box-archive w-6 mr-3"></i>
          <span>Produk</span>
        </a>
        <a
          href="dashboard-orders.html"
          class="nav-link flex items-center px-4 py-3 bg-amber-700"
        >
          <i class="fas fa-shopping-cart w-6 mr-3"></i>
          <span>Pesanan</span>
        </a>
        <a
          href="dashboard-settings.html"
          class="nav-link flex items-center px-4 py-3 hover:bg-amber-700 transition"
        >
          <i class="fas fa-gear w-6 mr-3"></i>
          <span>Pengaturan</span>
        </a>
      </nav>

      <div
        class="absolute bottom-0 left-0 right-0 p-4 border-t border-amber-700"
      >
        <div class="flex items-center mb-4">
          <div
            class="w-8 h-8 rounded-full bg-amber-600 flex items-center justify-center mr-2"
          >
            <i class="fas fa-user"></i>
          </div>
          <div>
            <p class="font-medium" id="admin-name">Admin</p>
            <p class="text-xs text-amber-200" id="admin-username">admin</p>
          </div>
        </div>
        <button
          id="logout-btn"
          class="w-full bg-amber-700 hover:bg-amber-600 text-white py-2 rounded transition"
        >
          <i class="fas fa-sign-out-alt mr-1"></i> Logout
        </button>
      </div>
    </div>

    <!-- Main Content -->
    <div class="content min-h-screen">
      <!-- Top Bar -->
      <div
        class="bg-white shadow-sm p-4 flex justify-between items-center sticky top-0 z-5"
      >
        <button id="toggle-sidebar" class="md:hidden text-amber-800">
          <i class="fas fa-bars text-xl"></i>
        </button>

        <div class="flex items-center space-x-4">
          <a
            href="../index.html"
            target="_blank"
            class="text-amber-800 hover:text-amber-600 transition"
          >
            <i class="fas fa-external-link-alt mr-1"></i> Lihat Website
          </a>
          <div class="relative">
            <button
              id="notifications-btn"
              class="text-amber-800 hover:text-amber-600 transition"
            >
              <i class="fas fa-bell text-xl"></i>
              <span
                class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs"
                >3</span
              >
            </button>
          </div>
          <button
            id="logout-btn"
            class="text-amber-800 hover:text-amber-600 transition"
          >
            <i class="fas fa-sign-out-alt text-xl"></i>
          </button>
        </div>
      </div>

      <!-- Page Content -->
      <div class="p-6">
        <div class="mb-6">
          <h1 class="text-2xl font-bold text-gray-800">Dashboard</h1>
          <p class="text-gray-600">
            Selamat datang di panel admin Batik Nusantara
          </p>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
          <div class="bg-white rounded-lg shadow p-6">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-gray-500 text-sm">Total Produk</p>
                <h3
                  class="text-2xl font-bold text-gray-800"
                  id="total-products"
                >
                  0
                </h3>
              </div>
              <div class="bg-blue-100 p-3 rounded-lg">
                <i class="fas fa-box-archive text-blue-500"></i>
              </div>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow p-6">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-gray-500 text-sm">Total Pemasanan</p>
                <h3 class="text-2xl font-bold text-gray-800" id="total-orders">
                  0
                </h3>
              </div>
              <div class="bg-green-100 p-3 rounded-lg">
                <i class="fas fa-shopping-cart text-green-500"></i>
              </div>
            </div>
          </div>
          <div class="bg-white rounded-lg shadow p-6">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-gray-500 text-sm">Pesanan Menunggu</p>
                <h3 class="text-2xl font-bold text-gray-800" id="new-orders">
                  0
                </h3>
              </div>
              <div class="bg-yellow-100 p-3 rounded-lg">
                <i class="fas fa-shopping-cart text-yellow-500"></i>
              </div>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow p-6">
            <div class="flex justify-between items-start">
              <div>
                <p class="text-gray-500 text-sm">Total Pendapatan</p>
                <h3 class="text-lg font-bold text-gray-800" id="total-revenue">
                  Rp 0
                </h3>
              </div>
              <div class="bg-purple-100 p-3 rounded-lg">
                <i class="fas fa-coins text-purple-500"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
          <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Aksi Cepat</h3>
            <div class="space-y-3">
              <a
                href="dashboard-products.html"
                class="w-full text-left flex items-center px-4 py-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition"
              >
                <i class="fas fa-plus mr-3 text-blue-600"></i>
                <span class="text-blue-600">Tambah Produk Baru</span>
              </a>
              <a
                href="dashboard-orders.html"
                class="w-full text-left flex items-center px-4 py-3 bg-green-50 hover:bg-green-100 rounded-lg transition"
              >
                <i class="fas fa-list mr-3 text-green-600"></i>
                <span class="text-green-600">Lihat Pesanan</span>
              </a>
              <button
                id="refresh-dashboard"
                class="w-full text-left flex items-center px-4 py-3 bg-amber-50 hover:bg-amber-100 rounded-lg transition"
              >
                <i class="fas fa-sync-alt mr-3 text-amber-600"></i>
                <span class="text-amber-600">Refresh Data</span>
              </button>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">
              Aktivitas Terbaru
            </h3>
            <div id="recent-activity" class="space-y-3">
              <div class="flex items-center text-sm text-gray-600">
                <i class="fas fa-spinner fa-spin mr-2 text-amber-600"></i>
                <span>Memuat aktivitas...</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">
              Grafik Penjualan
            </h3>
            <div
              class="h-64 flex items-center justify-center bg-gray-50 rounded-lg"
            >
              <div class="text-center text-gray-500">
                <i class="fas fa-chart-line text-3xl mb-2"></i>
                <p>Grafik akan ditampilkan di sini</p>
              </div>
            </div>
          </div>

          <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">
              Produk Terpopuler
            </h3>
            <div id="popular-products" class="space-y-3">
              <div class="flex items-center text-sm text-gray-600">
                <i class="fas fa-spinner fa-spin mr-2 text-amber-600"></i>
                <span>Memuat data produk...</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript Files -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="module" src="../assets/js/main.js"></script>
    <script defer src="../assets/js/admin-layout.js"></script>
    <script defer src="../assets/js/dashboard.js"></script>
    <script>
      // Ensure dashboard initialization works by adding fallback
      document.addEventListener('DOMContentLoaded', function() {
        console.log('Dashboard DOM loaded, checking for initialization...');

        // Wait for dependencies
        function checkAndInit() {
          if (typeof window.ApiService !== 'undefined' &&
              typeof window.Utils !== 'undefined' &&
              typeof window.AuthManager !== 'undefined') {
            console.log('Dependencies loaded for dashboard');

            // If dashboard didn't initialize for some reason, force it
            setTimeout(() => {
              if (typeof initDashboard === 'function') {
                console.log('Dashboard function available');
              } else {
                console.log('Dashboard function not available, retrying...');
                setTimeout(checkAndInit, 500);
              }
            }, 1000);
          } else {
            console.log('Waiting for dependencies...', {
              ApiService: typeof window.ApiService,
              Utils: typeof window.Utils,
              AuthManager: typeof window.AuthManager
            });
            setTimeout(checkAndInit, 100);
          }
        }

        checkAndInit();
      });
    </script>
  </body>
</html>
